"use strict";(()=>{var e={};e.id=961,e.ids=[961],e.modules={4722:e=>{e.exports=require("next-auth/react")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6762:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},5971:(e,t,r)=>{r.r(t),r.d(t,{config:()=>f,default:()=>c,routeModule:()=>l});var o={};r.r(o),r.d(o,{default:()=>u});var n=r(9947),s=r(2706),i=r(6762),a=r(4722);async function u(e,t){let{owner:r,repo:o,branch:n}=e.query,s=[];if(e.query.exclusions)try{s=JSON.parse(e.query.exclusions)}catch(e){console.error("Error parsing exclusions:",e),s=[]}let i=await (0,a.getSession)({req:e});if(!i)return t.status(401).json({error:"Unauthorized"});let u=i.accessToken;try{let e=await fetch(`https://api.github.com/repos/${r}/${o}/branches/${n}`,{headers:{Authorization:`token ${u}`}}),i=await e.json();if(i.message)return t.status(400).json({error:i.message});let a=i.commit.sha,c=await fetch(`https://api.github.com/repos/${r}/${o}/git/trees/${a}?recursive=1`,{headers:{Authorization:`token ${u}`}}),f=await c.json();if(f.message)return t.status(400).json({error:f.message});let l=f.tree,p=function(e){let t={};for(let r of e){let e=r.path.split("/"),o=t;for(let t of e)o[t]||(o[t]={}),o=o[t]}return t}(l),h=function e(t,r=""){let o="",n=Object.keys(t).sort();return n.forEach((s,i)=>{let a=i===n.length-1;o+=`${r}${a?"└── ":"├── "}${s}
`,o+=e(t[s],r+(a?"    ":"│   "))}),o}(p),d=0,g=`# Repository: ${r}/${o}
**Branch:** ${n}

`;for(let e of(g+=`## Folder Structure:
\`\`\`
${h}
\`\`\`

`,l)){if("blob"!==e.type||[".png",".jpg",".jpeg",".gif",".svg",".ico",".pdf",".exe"].some(t=>e.path.toLowerCase().endsWith(t))||s.some(t=>e.path.startsWith(t)))continue;let t=await fetch(e.url,{headers:{Authorization:`token ${u}`}}),r=await t.json();if("base64"!==r.encoding||!r.content)continue;let o=Buffer.from(r.content,"base64").toString("utf-8"),n=Math.ceil(o.length/4);g+=`## File: ${e.path}
\`\`\`
${o}
\`\`\`

`,d+=n}t.status(200).json({text:g,totalTokens:d})}catch(e){console.error("Error fetching repository:",e),t.status(500).json({error:"Internal Server Error"})}}let c=(0,i.M)(o,"default"),f=(0,i.M)(o,"config"),l=new n.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/fetchRepo",pathname:"/api/fetchRepo",bundlePath:"",filename:""},userland:o})},2706:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},9947:(e,t,r)=>{e.exports=r(5600)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=5971);module.exports=r})();